define("local_dta/experiences/view/modals",["exports","core/modal","core/modal_registry","local_dta/repositories/resources_repository","core/modal_factory","core/modal_events","local_dta/repositories/context_repository","jquery","./main","core/notification","local_dta/repositories/cases_repository","local_dta/resources/manage_resources"],(function(_exports,_modal,_modal_registry,_resources_repository,_modal_factory,_modal_events,_context_repository,_jquery,_main,_notification,_cases_repository,_manage_resources){var _class,_class2;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.displaylinkResourcesModal=_exports.displaylinkCoursesModal=void 0,_modal=_interopRequireDefault(_modal),_modal_registry=_interopRequireDefault(_modal_registry),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_jquery=_interopRequireDefault(_jquery),_notification=_interopRequireDefault(_notification);const linkResourcesModal=(_defineProperty(_class=class extends _modal.default{registerEventListeners(){super.registerEventListeners(),this.registerCloseOnSave(),this.registerCloseOnCancel()}},"TYPE","local_dta/linkResourcesModal"),_defineProperty(_class,"TEMPLATE","local_dta/experiences/view/modal-resources"),_class);_modal_registry.default.register(linkResourcesModal.TYPE,linkResourcesModal,linkResourcesModal.TEMPLATE);const linkCasesModal=(_defineProperty(_class2=class extends _modal.default{registerEventListeners(){super.registerEventListeners(),this.registerCloseOnSave(),this.registerCloseOnCancel()}},"TYPE","local_dta/linkCasesModal"),_defineProperty(_class2,"TEMPLATE","local_dta/experiences/view/modal-cases"),_class2);_modal_registry.default.register(linkCasesModal.TYPE,linkCasesModal,linkCasesModal.TEMPLATE);_exports.displaylinkResourcesModal=async change=>{const{resources:resources}=await(0,_resources_repository.getAllResources)(),modal=await _modal_factory.default.create({type:linkResourcesModal.TYPE,templateContext:{elementid_:Date.now(),resources:resources,change:change},large:!0});modal.show();const $root=modal.getRoot();if(change){const changeElement=$root.find("#changeToAddResource").get(0);changeElement&&(changeElement.onclick=()=>{(0,_manage_resources.displayDialogue)(!0),modal.hide()})}$root.on(_modal_events.default.save,(()=>{handleResourceModal()}))};const handleResourceModal=()=>{const experienceid=(0,_jquery.default)(_main.SELECTORS.INPUTS.experienceid).val(),seleccionados=[];(0,_jquery.default)("#resources-group input[type='checkbox']:checked").each((function(){seleccionados.push((0,_jquery.default)(this).val())}));const contextid=[];seleccionados.forEach((async resourceid=>{contextid.push((0,_context_repository.upsertContext)({component:"experience",componentinstance:experienceid,modifier:"resource",modifierinstance:resourceid}))})),Promise.all(contextid).then((()=>{window.location.reload()})).catch((error=>{_notification.default.exception(error)}))};_exports.displaylinkCoursesModal=async()=>{const{cases:cases}=await(0,_cases_repository.getCases)(),modal=await _modal_factory.default.create({type:linkCasesModal.TYPE,templateContext:{elementid_:Date.now(),cases:cases},large:!0});modal.show();modal.getRoot().on(_modal_events.default.save,(()=>{handleCoursesModal()}))};const handleCoursesModal=()=>{const experienceid=(0,_jquery.default)(_main.SELECTORS.INPUTS.experienceid).val(),seleccionados=[];(0,_jquery.default)("#cases-group input[type='checkbox']:checked").each((function(){seleccionados.push((0,_jquery.default)(this).val())}));const contextid=[];console.log(seleccionados),seleccionados.forEach((async caseid=>{contextid.push((0,_context_repository.upsertContext)({component:"experience",componentinstance:experienceid,modifier:"case",modifierinstance:caseid}))})),Promise.all(contextid).then((()=>{window.location.reload()})).catch((error=>{_notification.default.exception(error)}))}}));

//# sourceMappingURL=modals.min.js.map