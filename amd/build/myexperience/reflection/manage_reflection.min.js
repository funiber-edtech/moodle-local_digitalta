define("local_dta/myexperience/reflection/manage_reflection",["exports","jquery","core/modal_factory","core/modal_events","core/templates","core/str","editor_tiny/editor","local_dta/repositories/reflection_repository","core/notification","../../repositories/reflection_repository"],(function(_exports,_jquery,_modal_factory,_modal_events,_templates,_str,_editor,_reflection_repository,_notification,_reflection_repository2){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}let tinyConfig;function setDefaultTinyMCE(){(0,_jquery.default)(".editor").each((function(){var area;area=this.id,(0,_editor.setupForElementId)({elementId:"".concat(area),options:tinyConfig})}))}function activateStep(){let stepNum=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const steps=(0,_jquery.default)("#stepbar").find("li");for(let i=0;i<steps.length;i++)i<stepNum?(0,_jquery.default)(steps[i]).addClass("active"):(0,_jquery.default)(steps[i]).removeClass("active");switch(stepNum){case 1:showSection("what");break;case 2:showSection("so_what");break;case 3:showSection("now_what")}}function showSection(){let section=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"what";const sections=(0,_jquery.default)(".sections").find(".section");sections.each((function(){(0,_jquery.default)(this).attr("id")==="section_".concat(section)?((0,_jquery.default)(this).addClass("active"),(0,_jquery.default)(this).addClass("d-flex").removeClass("d-none")):((0,_jquery.default)(this).removeClass("active"),(0,_jquery.default)(this).addClass("d-none").removeClass("d-flex"))}))}function setEventListeners(){(0,_jquery.default)(document).on("click",".submit",(function(){!function(btn){const data=btn.data(),{target:target,group:group,id:id}=data,reflectionid=(0,_jquery.default)("#reflectionid").val(),content=window.tinyMCE.get(target).getContent();(0,_reflection_repository.sectionTextUpsert)({reflectionid:reflectionid,group:group,content:content,id:id}).then((()=>{_notification.default.addNotification({message:"Section saved successfully.",type:"success"})})).fail(_notification.default.exception)}((0,_jquery.default)(this))})),(0,_jquery.default)(document).on("click","#add_button",(function(){const importerParent=(0,_jquery.default)(this).closest("#importer"),importerDiv=importerParent.find("#import_div"),addIcon=(0,_jquery.default)(this).find("i");importerParent.hasClass("collapsed")?(importerParent.removeClass("collapsed"),importerDiv.css("display","flex"),addIcon.removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle")):(importerParent.addClass("collapsed"),importerDiv.hide(),addIcon.removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle"))})),(0,_jquery.default)(document).on("click","#btn_what",(function(){activateStep()})),(0,_jquery.default)(document).on("click","#btn_so_what",(function(){activateStep(2)})),(0,_jquery.default)(document).on("click","#btn_now_what",(function(){activateStep(3)})),(0,_jquery.default)(document).on("click",".import_button",(function(){switch((0,_jquery.default)(this).attr("id")){case"import_cases":!async function(){const cases=await(0,_reflection_repository2.getCases)(),saveModal=await _modal_factory.default.create({type:_modal_factory.default.types.SAVE_CANCEL,title:(0,_str.get_string)("experience_reflection_import_cases_title","local_dta"),body:_templates.default.render("local_dta/experiences/manage/import-case-modal",{cases:cases})});saveModal.setSaveButtonText("Import"),saveModal.getRoot().on(_modal_events.default.save,(()=>{const caseIds=[];saveModal.getRoot().find("input:checked").each((function(){caseIds.push((0,_jquery.default)(this).val())})),saveModal.hide(),console.log(caseIds)})),saveModal.show()}();break;case"import_resources":console.log("Import Resources")}})),(0,_jquery.default)((function(){activateStep()}))}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events),_templates=_interopRequireDefault(_templates),_notification=_interopRequireDefault(_notification);_exports.init=()=>{setEventListeners(),tinyConfig=window.dta_tiny_config,setDefaultTinyMCE()}}));

//# sourceMappingURL=manage_reflection.min.js.map