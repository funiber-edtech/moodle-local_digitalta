{"version":3,"file":"manage_reflection.min.js","sources":["../../../src/myexperience/reflection/manage_reflection.js"],"sourcesContent":["import $ from 'jquery';\r\nimport ModalFactory from 'core/modal_factory';\r\nimport Templates from 'core/templates';\r\nimport {get_string} from 'core/str';\r\nimport {setupForElementId} from 'editor_tiny/editor';\r\nimport {sectionTextUpsert} from 'local_dta/repositories/reflection_repository';\r\nimport Notification from 'core/notification';\r\n\r\nlet tinyConfig;\r\n\r\n/**\r\n * Create tinyMCE in an area.\r\n * @param {string} area - The id of the area to create tinyMCE in.\r\n * @return {void}\r\n */\r\nfunction createTinyMCE(area) {\r\n    setupForElementId({\r\n        elementId: `${area}`,\r\n        options: tinyConfig,\r\n    });\r\n}\r\n\r\n/**\r\n * Set event listeners for the module.\r\n * @return {void}\r\n * */\r\nfunction setDefaultTinyMCE() {\r\n  $('.editor').each(function() {\r\n    createTinyMCE(this.id);\r\n  });\r\n}\r\n\r\n/**\r\n * Set the tinyMCE config.\r\n * @return {void}\r\n */\r\nfunction setTinyConfig() {\r\n  tinyConfig = window.dta_tiny_config;\r\n}\r\n\r\n/**\r\n * Save the text section.\r\n * @param {object} btn - The data to save.\r\n * @return {void}\r\n */\r\nfunction saveTextSection(btn) {\r\n  const data = btn.data();\r\n  const {target, group, id} = data;\r\n  const reflectionid = $('#reflectionid').val();\r\n  const content = window.tinyMCE.get(target).getContent();\r\n  sectionTextUpsert({reflectionid, group, content, id}).then(() => {\r\n\r\n    // TODO: Hector, add the sectionid to the section so we can update it later.\r\n    // TODO: happy holidays :D be safe and have fun with your family\r\n    Notification.addNotification({\r\n        message: 'Section saved successfully.',\r\n        type: 'success'\r\n    });\r\n    return;\r\n\r\n  }).fail(Notification.exception);\r\n}\r\n\r\n/**\r\n * Show save case modal\r\n * @return {void}\r\n */\r\nasync function showImportCase() {\r\n  const saveModal = await ModalFactory.create({\r\n      title: get_string(\"experience_reflection_import_cases_title\", \"local_dta\"),\r\n      body: Templates.render('local_dta/experiences/reflection/import-case-modal', {\r\n      }),\r\n  });\r\n  saveModal.show();\r\n}\r\n\r\n\r\n/**\r\n * Set event listeners for the module.\r\n * @return {void}\r\n * */\r\nfunction setEventListeners() {\r\n    // Save section\r\n    $(document).on('click', '.submit', function() {\r\n      saveTextSection($(this));\r\n    });\r\n\r\n    // Collapse Sections\r\n    $(document).on('click', '.header', function() {\r\n      const section = $(this).closest('.section');\r\n      const content = section.find('.questions');\r\n      const collapseIcon = $(this).find('i');\r\n      if (section.hasClass('collapsed')) {\r\n        section.removeClass('collapsed');\r\n        content.css('display', 'flex');\r\n        collapseIcon.removeClass('fa-chevron-right').addClass('fa-chevron-down');\r\n      } else {\r\n        section.addClass('collapsed');\r\n        content.hide();\r\n        collapseIcon.removeClass('fa-chevron-down').addClass('fa-chevron-right');\r\n      }\r\n    });\r\n\r\n    // Add-Section-Menu Collapse\r\n    $(document).on('click', '#add_button', function() {\r\n      const importerParent = $(this).closest('#importer');\r\n      const importerDiv = importerParent.find('#import_div');\r\n      const addIcon = $(this).find('i');\r\n      // importerDiv.css('display', importerDiv.css('display') == 'flex' ? 'none' : 'flex');\r\n      if (importerParent.hasClass('collapsed')) {\r\n        importerParent.removeClass('collapsed');\r\n        importerDiv.css('display', 'flex');\r\n        addIcon.removeClass('fa fa-plus-circle').addClass('fa fa-minus-circle');\r\n      } else {\r\n        importerParent.addClass('collapsed');\r\n        importerDiv.hide();\r\n        addIcon.removeClass('fa fa-minus-circle').addClass('fa fa-plus-circle');\r\n      }\r\n    });\r\n\r\n    // Import Buttons\r\n    $(document).on('click', '.import_button', function() {\r\n      const buttonId = $(this).attr('id');\r\n\r\n      switch (buttonId) {\r\n        case 'tiny':\r\n          //eslint-disable-next-line no-console\r\n          console.log('Tiny');\r\n          break;\r\n        case 'tiny_record':\r\n          //eslint-disable-next-line no-console\r\n          console.log('Tiny Record');\r\n          break;\r\n        case 'import_cases':\r\n          showImportCase();\r\n          break;\r\n        case 'import_experiences':\r\n          //eslint-disable-next-line no-console\r\n          console.log('Import Experiences');\r\n          break;\r\n        case 'import_tutor_conc':\r\n          //eslint-disable-next-line no-console\r\n          console.log('Import Tutor Conc');\r\n          break;\r\n        case 'import_resources':\r\n          //eslint-disable-next-line no-console\r\n          console.log('Import Resources');\r\n          break;\r\n      }\r\n    });\r\n}\r\n\r\nexport const init = () => {\r\n    setEventListeners();\r\n    setTinyConfig();\r\n    setDefaultTinyMCE();\r\n};"],"names":["tinyConfig","setDefaultTinyMCE","each","area","this","id","elementId","options","setEventListeners","document","on","btn","data","target","group","reflectionid","val","content","window","tinyMCE","get","getContent","then","addNotification","message","type","fail","Notification","exception","saveTextSection","section","closest","find","collapseIcon","hasClass","removeClass","css","addClass","hide","importerParent","importerDiv","addIcon","attr","console","log","ModalFactory","create","title","body","Templates","render","show","showImportCase","dta_tiny_config"],"mappings":"yZAQIA,oBAkBKC,wCACL,WAAWC,MAAK,eAZGC,KAAAA,KAaLC,KAAKC,iCAZD,CACdC,oBAAcH,MACdI,QAASP,yBA+DRQ,wCAEHC,UAAUC,GAAG,QAAS,WAAW,qBAtCdC,WACjBC,KAAOD,IAAIC,QACXC,OAACA,OAADC,MAASA,MAATT,GAAgBA,IAAMO,KACtBG,cAAe,mBAAE,iBAAiBC,MAClCC,QAAUC,OAAOC,QAAQC,IAAIP,QAAQQ,0DACzB,CAACN,aAAAA,aAAcD,MAAAA,MAAOG,QAAAA,QAASZ,GAAAA,KAAKiB,MAAK,2BAI5CC,gBAAgB,CACzBC,QAAS,8BACTC,KAAM,eAITC,KAAKC,sBAAaC,WAwBjBC,EAAgB,mBAAEzB,8BAIlBK,UAAUC,GAAG,QAAS,WAAW,iBAC3BoB,SAAU,mBAAE1B,MAAM2B,QAAQ,YAC1Bd,QAAUa,QAAQE,KAAK,cACvBC,cAAe,mBAAE7B,MAAM4B,KAAK,KAC9BF,QAAQI,SAAS,cACnBJ,QAAQK,YAAY,aACpBlB,QAAQmB,IAAI,UAAW,QACvBH,aAAaE,YAAY,oBAAoBE,SAAS,qBAEtDP,QAAQO,SAAS,aACjBpB,QAAQqB,OACRL,aAAaE,YAAY,mBAAmBE,SAAS,4CAKvD5B,UAAUC,GAAG,QAAS,eAAe,iBAC/B6B,gBAAiB,mBAAEnC,MAAM2B,QAAQ,aACjCS,YAAcD,eAAeP,KAAK,eAClCS,SAAU,mBAAErC,MAAM4B,KAAK,KAEzBO,eAAeL,SAAS,cAC1BK,eAAeJ,YAAY,aAC3BK,YAAYJ,IAAI,UAAW,QAC3BK,QAAQN,YAAY,qBAAqBE,SAAS,wBAElDE,eAAeF,SAAS,aACxBG,YAAYF,OACZG,QAAQN,YAAY,sBAAsBE,SAAS,6CAKrD5B,UAAUC,GAAG,QAAS,kBAAkB,mBACvB,mBAAEN,MAAMsC,KAAK,WAGvB,OAEHC,QAAQC,IAAI,kBAET,cAEHD,QAAQC,IAAI,yBAET,wCAjEaC,uBAAaC,OAAO,CACxCC,OAAO,mBAAW,2CAA4C,aAC9DC,KAAMC,mBAAUC,OAAO,qDAAsD,OAGvEC,OA6DFC,aAEG,qBAEHT,QAAQC,IAAI,gCAET,oBAEHD,QAAQC,IAAI,+BAET,mBAEHD,QAAQC,IAAI,mTAMF,KAChBpC,oBApHFR,WAAakB,OAAOmC,gBAsHlBpD"}