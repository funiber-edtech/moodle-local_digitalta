{"version":3,"file":"manage_reflection.min.js","sources":["../../../src/myexperience/reflection/manage_reflection.js"],"sourcesContent":["import $ from 'jquery';\r\nimport {setupForElementId} from 'editor_tiny/editor';\r\nimport {sectionTextUpsert} from 'local_dta/repositories/reflection_repository';\r\nimport Notification from 'core/notification';\r\n\r\nlet tinyConfig;\r\n\r\n/**\r\n * Set the events for the module.\r\n * @return {void}\r\n */\r\nfunction setEvents() {\r\n  document.querySelectorAll('.section').forEach(section => {\r\n    var collapseButton = section.querySelector('.header');\r\n\r\n    if (collapseButton) {\r\n      collapseButton.addEventListener('click', () => {\r\n        var collapseIcon = collapseButton.querySelector('i');\r\n        var sectionContent = section.querySelector('.questions');\r\n        if (collapseButton.classList.contains('collapsed')) {\r\n          collapseButton.classList.remove('collapsed');\r\n          collapseIcon.classList.remove('fa-chevron-down');\r\n          collapseIcon.classList.add('fa-chevron-right');\r\n          sectionContent.style.display = 'none';\r\n        } else {\r\n          collapseButton.classList.add('collapsed');\r\n          collapseIcon.classList.remove('fa-chevron-right');\r\n          collapseIcon.classList.add('fa-chevron-down');\r\n          sectionContent.style.display = 'flex';\r\n        }\r\n      });\r\n    }\r\n});\r\n\r\n\r\n  document.querySelectorAll('#importer').forEach(importer => {\r\n    var addButton = importer.querySelector('#add_button');\r\n    var importerDiv = importer.querySelector('#import_div');\r\n\r\n    // Add Button Clic Event\r\n    addButton.addEventListener('click', () => {\r\n        importerDiv.style.display = importerDiv.style.display == 'flex' ? 'none' : 'flex';\r\n    });\r\n\r\n    importerDiv.querySelectorAll('.import_button').forEach(importButton => {\r\n      importButton.addEventListener('click', () => {\r\n        var buttonId = importButton.id;\r\n\r\n        switch (buttonId) {\r\n          case \"tiny\":\r\n            //eslint-disable-next-line no-console\r\n            console.log(\"Tiny\");\r\n            break;\r\n          case \"tiny_record\":\r\n            //eslint-disable-next-line no-console\r\n            console.log(\"Tiny Record\");\r\n            break;\r\n          case \"import_cases\":\r\n            //eslint-disable-next-line no-console\r\n            console.log(\"Import Cases\");\r\n            break;\r\n          case \"import_experiences\":\r\n            //eslint-disable-next-line no-console\r\n            console.log(\"Import Experiences\");\r\n            break;\r\n          case \"import_tutor_conc\":\r\n            //eslint-disable-next-line no-console\r\n            console.log(\"Import Tutor Conc\");\r\n            break;\r\n          case \"import_resources\":\r\n            //eslint-disable-next-line no-console\r\n            console.log(\"Import Resources\");\r\n            break;\r\n        }\r\n      });\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Create tinyMCE in an area.\r\n * @param {string} area - The id of the area to create tinyMCE in.\r\n * @return {void}\r\n */\r\nfunction createTinyMCE(area) {\r\n    setupForElementId({\r\n        elementId: `${area}`,\r\n        options: tinyConfig,\r\n    });\r\n}\r\n\r\n/**\r\n * Set event listeners for the module.\r\n * @return {void}\r\n * */\r\nfunction setDefaultTinyMCE() {\r\n  $('.editor').each(function() {\r\n    createTinyMCE(this.id);\r\n  });\r\n}\r\n\r\n/**\r\n * Set the tinyMCE config.\r\n * @return {void}\r\n */\r\nfunction setTinyConfig() {\r\n  tinyConfig = window.dta_tiny_config;\r\n}\r\n\r\n/**\r\n * Save the text section.\r\n * @param {object} btn - The data to save.\r\n * @return {void}\r\n */\r\nfunction saveTextSection(btn) {\r\n  const data = btn.data();\r\n  const {target, group} = data;\r\n  const reflectionid = $('#reflectionid').val();\r\n  const content = window.tinyMCE.get(target).getContent();\r\n  sectionTextUpsert({reflectionid, group, content}).then((sectionid) => {\r\n    // eslint-disable-next-line no-console\r\n    console.log(sectionid);\r\n    btn.data('sectionid', sectionid);\r\n\r\n    Notification.addNotification({\r\n        message: 'Section saved successfully.',\r\n        type: 'success'\r\n    });\r\n    return;\r\n  }).fail(Notification.exception);\r\n}\r\n\r\n\r\n/**\r\n * Set event listeners for the module.\r\n * @return {void}\r\n * */\r\nfunction setEventListeners() {\r\n    // Save section\r\n    $(document).on('click', '.submit', function() {\r\n      saveTextSection($(this));\r\n    });\r\n}\r\n\r\nexport const init = () => {\r\n    setEventListeners();\r\n    setEvents();\r\n    setTinyConfig();\r\n    setDefaultTinyMCE();\r\n};"],"names":["tinyConfig","setDefaultTinyMCE","each","area","this","id","elementId","options","setEventListeners","document","on","btn","data","target","group","reflectionid","val","content","window","tinyMCE","get","getContent","then","sectionid","console","log","addNotification","message","type","fail","Notification","exception","saveTextSection","querySelectorAll","forEach","section","collapseButton","querySelector","addEventListener","collapseIcon","sectionContent","classList","contains","remove","add","style","display","importer","addButton","importerDiv","importButton","dta_tiny_config"],"mappings":"yUAKIA,oBA0FKC,wCACL,WAAWC,MAAK,eAZGC,KAAAA,KAaLC,KAAKC,iCAZD,CACdC,oBAAcH,MACdI,QAASP,yBAkDRQ,wCAEHC,UAAUC,GAAG,QAAS,WAAW,qBAzBdC,WACjBC,KAAOD,IAAIC,QACXC,OAACA,OAADC,MAASA,OAASF,KAClBG,cAAe,mBAAE,iBAAiBC,MAClCC,QAAUC,OAAOC,QAAQC,IAAIP,QAAQQ,0DACzB,CAACN,aAAAA,aAAcD,MAAAA,MAAOG,QAAAA,UAAUK,MAAMC,YAEtDC,QAAQC,IAAIF,WACZZ,IAAIC,KAAK,YAAaW,iCAETG,gBAAgB,CACzBC,QAAS,8BACTC,KAAM,eAGTC,KAAKC,sBAAaC,WAWjBC,EAAgB,mBAAE5B,iMAIJ,KAChBI,oBArIFC,SAASwB,iBAAiB,YAAYC,SAAQC,cACxCC,eAAiBD,QAAQE,cAAc,WAEvCD,gBACFA,eAAeE,iBAAiB,SAAS,SACnCC,aAAeH,eAAeC,cAAc,KAC5CG,eAAiBL,QAAQE,cAAc,cACvCD,eAAeK,UAAUC,SAAS,cACpCN,eAAeK,UAAUE,OAAO,aAChCJ,aAAaE,UAAUE,OAAO,mBAC9BJ,aAAaE,UAAUG,IAAI,oBAC3BJ,eAAeK,MAAMC,QAAU,SAE/BV,eAAeK,UAAUG,IAAI,aAC7BL,aAAaE,UAAUE,OAAO,oBAC9BJ,aAAaE,UAAUG,IAAI,mBAC3BJ,eAAeK,MAAMC,QAAU,cAOvCrC,SAASwB,iBAAiB,aAAaC,SAAQa,eACzCC,UAAYD,SAASV,cAAc,eACnCY,YAAcF,SAASV,cAAc,eAGzCW,UAAUV,iBAAiB,SAAS,KAChCW,YAAYJ,MAAMC,QAAuC,QAA7BG,YAAYJ,MAAMC,QAAoB,OAAS,UAG/EG,YAAYhB,iBAAiB,kBAAkBC,SAAQgB,eACrDA,aAAaZ,iBAAiB,SAAS,YACtBY,aAAa7C,QAGrB,OAEHmB,QAAQC,IAAI,kBAET,cAEHD,QAAQC,IAAI,yBAET,eAEHD,QAAQC,IAAI,0BAET,qBAEHD,QAAQC,IAAI,gCAET,oBAEHD,QAAQC,IAAI,+BAET,mBAEHD,QAAQC,IAAI,8BAmCtBzB,WAAakB,OAAOiC,gBA0ClBlD"}
