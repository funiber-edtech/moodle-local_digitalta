define("local_dta/myexperience/manage/form",["exports","jquery","core/notification","./../../tiny/manage","./listeners","./steps","./../../repositories/experience_repository","local_dta/tags/autocomplete","../../files/filemanager"],(function(_exports,_jquery,_notification,_manage,_listeners,_steps,_experience_repository,_autocomplete,_filemanager){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}async function saveNewTag(tagName){try{return await(0,_experience_repository.createTags)({tag:tagName})}catch(error){return _notification.default.exception(error)}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.collapseAddSectionMenu=function(){const importerParent=(0,_jquery.default)(this).closest("#importer"),importerDiv=importerParent.find("#import_div"),addIcon=(0,_jquery.default)(this).find("i");importerParent.hasClass("collapsed")?(importerParent.removeClass("collapsed"),importerDiv.css("display","flex"),addIcon.removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle")):(importerParent.addClass("collapsed"),importerDiv.hide(),addIcon.removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle"))},_exports.handleNewTag=async function(selectedOptions){for(var i=0;i<selectedOptions.length;i++)if("-1"===selectedOptions[i].value){selectedOptions[i].label=selectedOptions[i].label.replace("Create: ","");const{id:id}=await saveNewTag(selectedOptions[i].label);selectedOptions[i].value=parseInt(id)}},_exports.init=void 0,_exports.saveExperience=async function(){const experienceTitle=(0,_jquery.default)("#experience_title").val(),experienceVisibility=(0,_jquery.default)("#experience_visibility").val(),experienceLang=(0,_jquery.default)("#experience_lang").val(),experienceIntroduction=window.tinyMCE.get("experience_introduction").getContent(),experienceProblem=window.tinyMCE.get("experience_problem").getContent(),tags=(0,_jquery.default)("#autocomplete_tags").val();try{const response=await(0,_experience_repository.experienceUpsert)({id:0,title:experienceTitle,description:experienceIntroduction,context:experienceProblem,lang:experienceLang,visible:experienceVisibility,tags:tags});return(0,_filemanager.saveFiles)("featurePicture","fileManager",response.experienceid,"experience_picture"),_notification.default.addNotification({message:"Experience saved successfully.",type:"success"}),void(0,_steps.activateStep)(2)}catch(error){_notification.default.exception(error)}},_jquery=_interopRequireDefault(_jquery),_notification=_interopRequireDefault(_notification);_exports.init=()=>{(0,_jquery.default)(".editor").each((function(){(0,_manage.createTinyMCE)(this.id)})),(0,_autocomplete.autocompleteTags)(),(0,_steps.activateStep)(),(0,_listeners.setEventListeners)()}}));

//# sourceMappingURL=form.min.js.map