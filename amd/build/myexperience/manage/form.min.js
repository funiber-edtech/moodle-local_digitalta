define("local_dta/myexperience/manage/form",["exports","jquery","core/notification","./../../tiny/manage","./listeners","./steps","local_dta/repositories/experience_repository","local_dta/repositories/reflection_repository","local_dta/tags/autocomplete","../../files/filemanager"],(function(_exports,_jquery,_notification,_manage,_listeners,_steps,_experience_repository,_reflection_repository,_autocomplete,_filemanager){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.collapseAddSectionMenu=function(){const importerParent=(0,_jquery.default)(this).closest("#importer"),importerDiv=importerParent.find("#import_div"),addIcon=(0,_jquery.default)(this).find("i");importerParent.hasClass("collapsed")?(importerParent.removeClass("collapsed"),importerDiv.css("display","flex"),addIcon.removeClass("fa fa-plus-circle").addClass("fa fa-minus-circle")):(importerParent.addClass("collapsed"),importerDiv.hide(),addIcon.removeClass("fa fa-minus-circle").addClass("fa fa-plus-circle"))},_exports.init=void 0,_exports.saveExperience=async function(){const experienceTitle=(0,_jquery.default)("#experience_title").val(),experienceVisibility=(0,_jquery.default)("#experience_visibility").val(),experienceLang=(0,_jquery.default)("#experience_lang").val(),experienceIntroduction=window.tinyMCE.get("experience_introduction").getContent(),experienceProblem=window.tinyMCE.get("experience_problem").getContent(),experienceid=(0,_jquery.default)("#experience_id").val(),tags=(0,_jquery.default)("#autocomplete_tags").val();try{const response=await(0,_experience_repository.experienceUpsert)({id:experienceid||0,title:experienceTitle,description:experienceIntroduction,context:experienceProblem,lang:experienceLang,visible:experienceVisibility,tags:tags});await(0,_filemanager.saveFiles)("featurePicture","fileManager",response.experienceid,"experience_picture"),_notification.default.addNotification({message:"Experience saved successfully.",type:"success"}),(0,_steps.activateStep)(2),(0,_jquery.default)("#reflectionid").val(response.reflectionid),(0,_jquery.default)("#experience_id").val(response.experienceid)}catch(error){_notification.default.exception(error)}},_exports.saveTextSection=function(btn,step){const data=btn.data(),{target:target,group:group}=data,reflectionid=(0,_jquery.default)("#reflectionid").val(),content=(0,_manage.getTinyMCEContent)(target);(0,_reflection_repository.sectionTextUpsert)({reflectionid:reflectionid,group:group,content:content}).then((()=>{_notification.default.addNotification({message:"Section saved successfully.",type:"success"}),3===step&&(window.location.href="./view.php?id="+(0,_jquery.default)("#experience_id").val()),(0,_steps.activateStep)(step+1)})).fail(_notification.default.exception)},_jquery=_interopRequireDefault(_jquery),_notification=_interopRequireDefault(_notification);_exports.init=()=>{(0,_filemanager.init)("featurePicture"),(0,_jquery.default)(".editor").each((function(){(0,_manage.createTinyMCE)(this.id)})),(0,_autocomplete.autocompleteTags)("#autocomplete_tags"),(0,_steps.activateStep)(),(0,_listeners.setEventListeners)()}}));

//# sourceMappingURL=form.min.js.map