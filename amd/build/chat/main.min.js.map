{"version":3,"file":"main.min.js","sources":["../../src/chat/main.js"],"sourcesContent":["import $ from 'jquery';\r\nimport Template from 'core/templates';\r\nimport Notification from 'core/notification';\r\nimport SELECTORS from './selectors';\r\nimport {getChatRooms, sendMessage} from 'local_dta/repositories/chat_repository';\r\nimport setEventListeners from './listeners';\r\n\r\n\r\n/**\r\n * Create a chat in the target\r\n * @param {string} target\r\n */\r\nexport default function createChatInTarget(target) {\r\n    SELECTORS.TARGET = target;\r\n    initComponent();\r\n    return;\r\n}\r\n\r\n// Initialize the component\r\nconst initComponent = () => {\r\n    setEventListeners();\r\n    renderMenuChat();\r\n};\r\n\r\n/**\r\n * Render menu chat\r\n */\r\nexport async function renderMenuChat() {\r\n    const {chatrooms} = await getChatRooms();\r\n    Template.render(SELECTORS.TEMPLATES.MENU_CHAT, {\r\n        chatrooms\r\n    }).then((html) => {\r\n        $(SELECTORS.TARGET).html(html);\r\n        return;\r\n    }).fail(Notification.exception);\r\n}\r\n\r\n/**\r\n * Open chat\r\n * @param {number} id\r\n * Render chat\r\n */\r\nexport async function renderChat(id) {\r\n    SELECTORS.OPEN_CHAT_ID = id;\r\n    Template.render(SELECTORS.TEMPLATES.CHAT, {\r\n        SELECTORS\r\n    }).then((html) => {\r\n        $(SELECTORS.TARGET).html(html);\r\n        return;\r\n    }).fail(Notification.exception);\r\n}\r\n\r\n/**\r\n * Handle send message\r\n * @returns {Promise}\r\n */\r\nexport async function handleSendMessage() {\r\n    const message = $(SELECTORS.INPUTS.CHAT_REPLY).val().trim();\r\n    sendMessage({\r\n        chatid: SELECTORS.OPEN_CHAT_ID,\r\n        message,\r\n    }).then(() => {\r\n        $(SELECTORS.INPUTS.CHAT_REPLY).val('');\r\n        renderChat(SELECTORS.OPEN_CHAT_ID);\r\n        return;\r\n    }).fail(Notification.exception);\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(message);\r\n    return;\r\n}"],"names":["target","TARGET","initComponent","message","SELECTORS","INPUTS","CHAT_REPLY","val","trim","chatid","OPEN_CHAT_ID","then","renderChat","fail","Notification","exception","console","log","renderMenuChat","chatrooms","render","TEMPLATES","MENU_CHAT","html","id","CHAT"],"mappings":"4ZAY2CA,kCAC7BC,OAASD,YACnBE,mEA2CMC,SAAU,mBAAEC,mBAAUC,OAAOC,YAAYC,MAAMC,8CACzC,CACRC,OAAQL,mBAAUM,aAClBP,QAAAA,UACDQ,MAAK,yBACFP,mBAAUC,OAAOC,YAAYC,IAAI,IACnCK,WAAWR,mBAAUM,iBAEtBG,KAAKC,sBAAaC,gBAGrBC,QAAQC,IAAId,4TAjDVD,cAAgB,8BAElBgB,iCAMkBA,uBACZC,UAACA,iBAAmB,sDACjBC,OAAOhB,mBAAUiB,UAAUC,UAAW,CAC3CH,UAAAA,YACDR,MAAMY,2BACHnB,mBAAUH,QAAQsB,KAAKA,SAE1BV,KAAKC,sBAAaC,0BAQHH,WAAWY,uBACnBd,aAAec,sBAChBJ,OAAOhB,mBAAUiB,UAAUI,KAAM,CACtCrB,UAAAA,qBACDO,MAAMY,2BACHnB,mBAAUH,QAAQsB,KAAKA,SAE1BV,KAAKC,sBAAaC"}