{"version":3,"file":"likes_dislikes.min.js","sources":["../../src/reactions/likes_dislikes.js"],"sourcesContent":["import $ from \"jquery\";\r\nimport { toogleLikeAndDislike } from \"local_dta/repositories/reactions_repository\";\r\nimport { SELECTORS } from \"./selectors\";\r\nimport Notification from \"core/notification\";\r\n\r\n/**\r\n * Update the like and dislike buttons in the UI.\r\n * @param {number} instanceid - The id of the experience.\r\n * @param {number} likes - The number of likes.\r\n * @param {number} dislikes - The number of dislikes.\r\n * @param {number} reaction - The reaction to add. 1 for like, 0 for dislike.\r\n * @return {void}\r\n */\r\nfunction updateUI(instanceid, likes, dislikes, reaction) {\r\n  const reactionSelectors = {\r\n    1: SELECTORS.BUTTONS.likes,\r\n    0: SELECTORS.BUTTONS.dislikes,\r\n  };\r\n\r\n  $(SELECTORS.BUTTONS.likes + SELECTORS.DATA.id(instanceid)).removeClass(\"active\");\r\n  $(SELECTORS.BUTTONS.dislikes + SELECTORS.DATA.id(instanceid)).removeClass(\"active\");\r\n\r\n  if (reactionSelectors.hasOwnProperty(reaction)) {\r\n    $(reactionSelectors[reaction] + SELECTORS.DATA.id(instanceid)).addClass(\"active\");\r\n  }\r\n\r\n  const likesText = likes ? likes : \"\";\r\n  $(SELECTORS.DATA.id(instanceid) + SELECTORS.COUNTS.likes).text(likesText);\r\n}\r\n\r\n/**\r\n * Toggle the like and dislike buttons.\r\n * @param {number} instanceid - The id of the instance\r\n * @param {number} reaction - The reaction to add. 1 for like, 0 for dislike.\r\n */\r\nexport function toggle(instanceid, reaction = null) {\r\n  const instancetype = $(SELECTORS.BUTTONS.likes).data(\"instance\");\r\n  const reactionSelectors = {\r\n    1: SELECTORS.BUTTONS.likes,\r\n    0: SELECTORS.BUTTONS.dislikes,\r\n  };\r\n  const isActive = $(reactionSelectors[reaction] + SELECTORS.DATA.id(instanceid)).hasClass(\"active\");\r\n  const action = isActive ? null : reaction;\r\n  toogleLikeAndDislike({instancetype, instanceid, action})\r\n    .then((response) => {\r\n      return updateUI(instanceid, response.likes, response.dislikes, action);\r\n    })\r\n    .fail(Notification.exception);\r\n}\r\n"],"names":["updateUI","instanceid","likes","dislikes","reaction","reactionSelectors","SELECTORS","BUTTONS","DATA","id","removeClass","hasOwnProperty","addClass","likesText","COUNTS","text","instancetype","data","isActive","hasClass","action","then","response","fail","Notification","exception"],"mappings":"uTAaSA,SAASC,WAAYC,MAAOC,SAAUC,gBACvCC,kBAAoB,GACrBC,qBAAUC,QAAQL,QAClBI,qBAAUC,QAAQJ,8BAGrBG,qBAAUC,QAAQL,MAAQI,qBAAUE,KAAKC,GAAGR,aAAaS,YAAY,8BACrEJ,qBAAUC,QAAQJ,SAAWG,qBAAUE,KAAKC,GAAGR,aAAaS,YAAY,UAEtEL,kBAAkBM,eAAeP,+BACjCC,kBAAkBD,UAAYE,qBAAUE,KAAKC,GAAGR,aAAaW,SAAS,gBAGpEC,UAAYX,OAAgB,uBAChCI,qBAAUE,KAAKC,GAAGR,YAAcK,qBAAUQ,OAAOZ,OAAOa,KAAKF,4FAQ1CZ,gBAAYG,gEAAW,WACtCY,cAAe,mBAAEV,qBAAUC,QAAQL,OAAOe,KAAK,YAC/CZ,kBAAoB,GACrBC,qBAAUC,QAAQL,QAClBI,qBAAUC,QAAQJ,UAEjBe,UAAW,mBAAEb,kBAAkBD,UAAYE,qBAAUE,KAAKC,GAAGR,aAAakB,SAAS,UACnFC,OAASF,SAAW,KAAOd,wDACZ,CAACY,aAAAA,aAAcf,WAAAA,WAAYmB,OAAAA,SAC7CC,MAAMC,UACEtB,SAASC,WAAYqB,SAASpB,MAAOoB,SAASnB,SAAUiB,UAEhEG,KAAKC,sBAAaC"}