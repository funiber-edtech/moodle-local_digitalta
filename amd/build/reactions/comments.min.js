define("local_digitalta/reactions/comments",["exports","jquery","core/templates","core/notification","local_digitalta/reactions/selectors","local_digitalta/repositories/reactions_repository"],(function(_exports,_jquery,_templates,_notification,_selectors,_reactions_repository){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}async function updateUI(){const component=(0,_jquery.default)(_selectors.SELECTORS.BUTTONS.comment).data("component"),componentinstance=(0,_jquery.default)(_selectors.SELECTORS.ACTIONS.sendComment).data("id");if(componentinstance)try{const response=await(0,_reactions_repository.reactionsGetComments)({component:component,componentinstance:componentinstance});let comments=[];response.result&&response.comments&&(comments=response.comments.map((comment=>({comment:comment.comment,created:comment.created_raw,userfullname:comment.user.fullname,userprofileurl:M.cfg.wwwroot+"/user/profile.php?id="+comment.user.id}))));const html=await _templates.default.render("local_digitalta/reactions/comments",{comments:comments});(0,_jquery.default)(_selectors.SELECTORS.COMMENTS.list).html(html),(0,_jquery.default)(_selectors.SELECTORS.ACTIONS.viewComments+_selectors.SELECTORS.DATA.id(componentinstance)+" span").text(comments.length?comments.length:"")}catch(error){_notification.default.exception(error)}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.sendComment=function(){const component=(0,_jquery.default)(_selectors.SELECTORS.BUTTONS.comment).data("component"),componentinstance=(0,_jquery.default)(_selectors.SELECTORS.ACTIONS.sendComment).data("id"),comment=(0,_jquery.default)(_selectors.SELECTORS.COMMENTS.input).val().trim();comment&&((0,_reactions_repository.reactionsAddComment)({component:component,componentinstance:componentinstance,comment:comment}).then((response=>response.result?updateUI():_notification.default.exception(response))).fail(_notification.default.exception),(0,_jquery.default)(_selectors.SELECTORS.COMMENTS.input).val(""))},_exports.updateUI=updateUI,_jquery=_interopRequireDefault(_jquery),_templates=_interopRequireDefault(_templates),_notification=_interopRequireDefault(_notification)}));

//# sourceMappingURL=comments.min.js.map