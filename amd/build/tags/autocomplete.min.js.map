{"version":3,"file":"autocomplete.min.js","sources":["../../src/tags/autocomplete.js"],"sourcesContent":["import Autocomplete from \"theme_dta/form-autocomplete\";\nimport {createTags} from \"local_dta/repositories/autocomplete_repository\";\nimport Notification from \"core/notification\";\n\n\n/**\n * Autocomplete tags.\n * @param {HTMLElement} area - The area to autocomplete.\n * @return {void}\n */\nexport function autocompleteTags(area) {\n    Autocomplete.enhance(area, null, \"local_dta/tags/autocomplete_method\");\n    area = area.replace(\"#\", \"\");\n    document.getElementById(area).addEventListener(\"change\", function(e) {\n        handleNewTag(e.target.selectedOptions);\n    });\n}\n\n/**\n * Handle new tag.\n * @param {Array} selectedOptions - The selected options.\n * @return {void}\n */\nasync function handleNewTag(selectedOptions) {\n\n    for (var i = 0; i < selectedOptions.length; i++) {\n      if (selectedOptions[i].value === \"-1\") {\n        selectedOptions[i].label = selectedOptions[i].label.replace(\"Create: \", \"\");\n        const {id} = await saveNewTag(selectedOptions[i].label);\n        selectedOptions[i].value = parseInt(id);\n      }\n    }\n}\n\n/**\n * Save new tag\n * @param {string} tagName - The tag name.\n * @return {Promise}\n */\nasync function saveNewTag(tagName) {\n    try {\n      return await createTags({\n        tag: tagName\n      });\n    } catch (error) {\n      return Notification.exception(error);\n    }\n}"],"names":["saveNewTag","tagName","tag","error","Notification","exception","area","enhance","replace","document","getElementById","addEventListener","e","selectedOptions","i","length","value","label","id","parseInt","handleNewTag","target"],"mappings":"kUAuCeA,WAAWC,0BAEP,uCAAW,CACtBC,IAAKD,UAEP,MAAOE,cACAC,sBAAaC,UAAUF,mGAnCHG,gCAChBC,QAAQD,KAAM,KAAM,sCACjCA,KAAOA,KAAKE,QAAQ,IAAK,IACzBC,SAASC,eAAeJ,MAAMK,iBAAiB,UAAU,SAASC,mBAU1CC,qBAEnB,IAAIC,EAAI,EAAGA,EAAID,gBAAgBE,OAAQD,OACT,OAA7BD,gBAAgBC,GAAGE,MAAgB,CACrCH,gBAAgBC,GAAGG,MAAQJ,gBAAgBC,GAAGG,MAAMT,QAAQ,WAAY,UAClEU,GAACA,UAAYlB,WAAWa,gBAAgBC,GAAGG,OACjDJ,gBAAgBC,GAAGE,MAAQG,SAASD,KAfpCE,CAAaR,EAAES,OAAOR"}