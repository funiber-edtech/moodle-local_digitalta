define("local_dta/resources/manage_resources",["exports","core/modal_factory","local_dta/resources/add_resource_modal","local_dta/experiences/view/modals","core/modal_events","core/normalise","local_dta/repositories/resources_repository","core/notification"],(function(_exports,_modal_factory,_add_resource_modal,_modals,_modal_events,_normalise,_resources_repository,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.displayDialogue=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_add_resource_modal=_interopRequireDefault(_add_resource_modal),_modal_events=_interopRequireDefault(_modal_events),_notification=_interopRequireDefault(_notification);const displayDialogue=async options=>{const modal=await _modal_factory.default.create({type:_add_resource_modal.default.TYPE,templateContext:{elementid_:Date.now(),themes:options.themes,tags:options.tags,types:options.types,format_input_id:options.format_id,languages:[{value:"es",text:"Spanish"},{value:"en",text:"English"}],change:options.change},large:!0});modal.show();const $root=modal.getRoot();if(options.change){const changeElement=$root.find("#changeToImportResource").get(0);changeElement&&(changeElement.onclick=()=>{(0,_modals.displaylinkResourcesModal)(!0),modal.hide()})}$root.on(_modal_events.default.save,((event,modal)=>{(async(event,modal)=>{const form=(0,_normalise.getList)(modal.getRoot())[0].querySelector("form");if(!form)return;const formData={id:0,name:form.querySelector('input[name="nameInput"]').value,path:form.querySelector('input[name="urlInput"]').value,description:form.querySelector('textarea[name="descriptionInput"]').value,themes:Array.from(form.querySelectorAll('select[name="themeSelect"] option:checked'),(option=>option.value)),tags:Array.from(form.querySelectorAll('select[name="tagSelect"] option:checked'),(option=>option.value)),type:form.querySelector('select[name="typeSelect"]').value,format:form.querySelector('input[name="formatInput"]').value,lang:form.querySelector('select[name="languageSelect"]').value};try{await(0,_resources_repository.resourcesUpsert)(formData)}catch(error){_notification.default.exception(error)}})(0,modal)}))};_exports.displayDialogue=displayDialogue;_exports.init=options=>{void 0===options.change&&(options.change=!1),document.getElementById("addResourceButton").addEventListener("click",(()=>displayDialogue(options)))}}));

//# sourceMappingURL=manage_resources.min.js.map